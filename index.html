<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Bipartite matching generalizations for peptide identification in tandem mass spectrometry by melodi-lab</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Bipartite matching generalizations for peptide identification in tandem mass spectrometry</h1>
      <h2 class="project-tagline"></h2>
      <a href="https://github.com/melodi-lab/SGM" class="btn">View on GitHub</a>
      <a href="https://github.com/melodi-lab/SGM/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/melodi-lab/SGM/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
       
      <h3>
        
       <a id="Main paper" class="anchor" href="Main paper" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Main paper</h3>
      
<p>  Wenruo Bai, Jeffrey Bilmes, and William S. Noble. Bipartite Matching Generalizations for Peptide Identification in Tandem Mass Spectrometry. In 7th ACM Conference on Bioinformatics, Computational Biology, and Health Informatics (ACM BCB), ACM SIGBio, ACM SIGBio, Seattle, WA, October 2016

<p><a href="https://github.com/melodi-lab/SGM/blob/master/paper%2080.pdf">Main paper</a>
<p><a href="https://github.com/melodi-lab/SGM/blob/master/BipartiteMatchingGeneralizations.pdf">Longer version with appendix</a>
<p><a href="https://github.com/melodi-lab/SGM/">Source Codes</a>

<h3>
<a id="Abstract" class="anchor" href="#Abstract" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Abstract</h3>

<p>  Motivation: Identication of spectra produced by a shotgun proteomics mass spectrometry experiment is commonly performed by searching the observed spectra against a peptide database. The heart of this search procedure is a score function that evaluates the quality of a hypothesized match between an observed spectrum and a theoretical spectrum corresponding to a particular peptide sequence. Accordingly, the success of a spectrum analysis pipeline depends critically upon this peptide-spectrum score function. 

<p>  Results: We developed peptide-spectrum score functions that compute the maximum value of a submodular function under m matroid constraints. We call this procedure a submodular generalized matching (SGM) since it generalizes bipartite matching. We use a greedy algorithm to compute maximization, which can achieve a solution whose objective is guaranteed to be at least 1/(1+m) of the true optimum. The advantage of the SGM framework is that known long-range properties of experimental spectra can be modeled by designing suitable submodular functions and matroid constraints. Experiments on four data sets from various organisms and mass spectrometry platforms show that the SGM approach leads to signicantly improved performance compared to several state-of-the-art methods.

<h3>
<a id="Data-set" class="anchor" href="#Data-set" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Data sets</h3>
<table>
  <tr>
    <th>Organism</th>
    <th>Resolution of precursor</th>
    <th>Resolution of fragment ions</th>
    <th>Number of runs</th>
    <th>Number of Spectra</th>
    
  </tr>
    <tr>
    <th> <a href="https://drive.google.com/file/d/0BxyhjntpdE6lVFlVNVUtTnZYN0U/view?usp=sharing">Yeast</a> </th>
    <th>3.0Da</th>
    <th>1.0005079Da</th>
    <th>3</th>
    <th>108,291</th>
  </tr>
  
    </tr>
    <tr>
    <th> <a href="https://drive.google.com/file/d/0BxyhjntpdE6lLTBOdDA4Qy1vVVE/view?usp=sharing">Worm</a> </th>
    <th>3.0Da</th>
    <th>1.0005079Da</th>
    <th>3</th>
    <th>68,252</th>
  </tr>
  
  </tr>
    <tr>
    <th> <a href="https://drive.google.com/file/d/0BxyhjntpdE6lMk0wUkVvT0lMaDg/view?usp=sharing">Plasmodium</a> </th>
    <th>50ppm</th>
    <th>0.03Da</th>
    <th>20</th>
    <th>240,762</th>
  </tr>
  
    </tr>
    <tr>
    <th> <a href="https://drive.google.com/file/d/0BxyhjntpdE6lOEJ3RGpGRFFNN0U/view?usp=sharing">Human</a> </th>
    <th>10ppm</th>
    <th>0.02Da</th>
    <th>100</th>
    <th>1,133,534</th>
  </tr>
 
</table>


  <H2> User document </H2>
  
     <H3>Step 1: Run tide-index of <a href="http://crux.ms/">Crux</a> to generate decoy set.</H3>
     <P>
    CRUX tide-index --output-dir [OUTPUT] --clip-nterm-methionine T \<br /> 
    --missed-cleavages [Missed cleavage] --peptide-list T \ <br />
    --mods-spec [MODS] --nterm-peptide-mods-spec [Nterm] \ <br />    
    --enzyme [ENZYME] \ <br />
    --overwrite T \ <br />
    [TARGETS] [tideindex] <br />
    <br />

    See <a href="http://crux.ms/commands/tide-index.html">Crux</a> for desired parameters. <br />

    Save tide-index.peptides.target.txt and tide-index.peptides.decoy.txt for input of next step. <br />

  </P>
   

   <H3>Step 2: Run "write_msms_bipartite.py" to generate input file for SGM. </H3>
  <P>

  python $SHARDDATA \ <br />
    --spectra [MS2FILE] \ <br /> 
    --num_spectra $(grep -c '^S' [MS2FILE]) \ <br />
    --targets tide-index.peptides.target.txt \ <br />
    --decoys tide-index.peptides.decoy.txt \ <br />
    --tol [TOL] \ <br />
    --shards 1 \ <br />
    --output_dir [ENCODE] \ <br />
    --ppm \ <br />
    --charges [CHARGE] <br /> <br />

  for pickle in ENCODE/shard-*.pickle <br />
  do <br />
    python write_msms_bipartite.py--output [ENCODE] --pickle $pickle \ <br />
    --max_mass 2000 --targets_per_spectrum 100000 \ <br />
    --normalize fastSequestTransform  \ <br />
    --bin_width 1.0005079 --bin_offset 0.68 --charge [CHARGE] \ <br />
    --bipartite_file [bipartite-OUTPUT] \ <br />
    --xcorr_ident_file [xcorrIdent-OUTPUT] \ <br />
    --do_not_write_all_psms --foreground <br />
  done <br />

  [ENCODE] is the output folder. [TOL] is the MS1 torrlerance in ppm. [CHARGE] is the precursor charge. [bipartite-OUTPUT] and [xcorrIdent-OUTPUT] are two output files.

  </P>
 <H3>Step 3: Run SGM. </H3>
 Complie and run with following parameters.
 </P>
option: -h  show help information <br />
<span style="display:inline-block; width: 55;"></span>        -c  charge <br />
<span style="display:inline-block; width: 55;"></span>          -i  [bipartite-OUTPUT] <br />
<span style="display:inline-block; width: 55;"></span>          -o  output file <br />
<span style="display:inline-block; width: 55;"></span>          -m  ms2file <br />

          </P>

<H3>Optional: Merge different charge state. </H3>
<P>run merge.py</P>

<H4>Optional: Draw absulte plot. </H3>
<P>run absplot.py</P>
<H2> TODO </H2>

<P>Make the codes more user friendly. </P>


</div>


<h3>

<a id="support-or-contact" class="anchor" href="#support-or-contact" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Support or Contact</h3>

<p>Please send comments and questions to wrbai@uw.edu.
      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/melodi-lab/SGM">Bipartite matching generalizations for peptide identification in tandem mass spectrometry</a> is maintained by <a href="https://github.com/melodi-lab">melodi-lab</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
